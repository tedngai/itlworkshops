<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Data Visualization Part 3 Processing the MoMA Collection | pratt itl </title> <meta name="description" content=" Pandas, Plotly, Regular Expression "> <meta name="keywords" content="technology, education, art, design, new york, brooklyn, architecture"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="ITL"> <meta property="article:section" content=""> <meta property="article:tag" content=""> <meta property="article:published_time" content="2019-02-19 00:00:00 -0500"> <meta property="og:url" content="http://localhost:4000/itlworkshops/2019/DataViz03/"> <meta property="og:title" content=" Data Visualization Part 3 Processing the MoMA Collection | pratt itl "> <meta property="og:image" content="http://localhost:4000/itlworkshops"> <meta property="og:description" content=" Pandas, Plotly, Regular Expression "> <meta property="og:site_name" content="ITL"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content=""> <meta name="twitter:title" content=" Data Visualization Part 3 Processing the MoMA Collection | pratt itl "> <meta name="twitter:description" content=" Pandas, Plotly, Regular Expression "> <meta name="twitter:image:src" content="http://localhost:4000/itlworkshops"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Data Visualization Part 3 Processing the MoMA Collection | pratt itl "> <meta itemprop="description" content=" Pandas, Plotly, Regular Expression "> <meta itemprop="image" content="http://localhost:4000/itlworkshops"> <!-- Canonical link tag --> <link rel="canonical" href="http://localhost:4000/itlworkshops/2019/DataViz03/"> <link rel="alternate" type="application/rss+xml" title="pratt itl" href="http://localhost:4000/itlworkshops/feed.xml"> <!-- rel prev and next --> <link rel="stylesheet" href="http://localhost:4000/itlworkshops/assets/css/main.css"> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="http://localhost:4000/itlworkshops/">pratt <span>itl</span></a></h1> <ul class="navbar"> <li><a href="http://localhost:4000/itlworkshops/about">About me</a></li> <li><a href="http://localhost:4000/itlworkshops/feed.xml" target="_blank">RSS</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2019-02-19T00:00:00-05:00" itemprop="datePublished">Feb 19, 2019</time></p> <h1 class="post-title" itemprop="name headline">Data Visualization Part 3 Processing the MoMA Collection</h1> </header> <div class="post-content" itemprop="articleBody"> <hr /> <h2 id="project-description">Project Description</h2> <p>This data visualization module is inspired by MoMA’s <a href="https://github.com/MuseumofModernArt/collection">data dump</a> in 2015. MoMA had release the database of their collection which contains over 130,000 pieces of artwork over the timespan of 150 years. In this session, we will learn to visualise MoMA collection similar to what <a href="https://fivethirtyeight.com/features/a-nerds-guide-to-the-2229-paintings-at-moma/">Oliver Roeder</a> had done at <a href="https://fivethirtyeight.com/">FiveThirtyEight</a>, perhaps we will even take it further. This session will allow us to dive into Pandas, Plot.ly, and python regular expression a lot more and get into some of the more intermediate level of data processing. In the course this this workshop, we will try to re-create some of Oliver’s visualizations such as these.</p> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/66.embed"></iframe> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/103.embed"></iframe> <hr /> <h1 id="step-1">Step 1</h1> <h3 id="import-libraries-and-data">Import Libraries and Data</h3> <p>This workshop module assumes you have already installed all the necessary python libraries, if you have not done so, please go back to the previous module. What we will need for this session is Plotly and Pandas, and we will run the entire session on Jupyter.</p> <p>First import all the libraries by executing the following code.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="k">as</span> <span class="n">py</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">download_plotlyjs</span><span class="p">,</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">iplot</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <p>Import the csv file by executing the following code.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://github.com/MuseumofModernArt/collection/blob/master/Artworks.csv'</span><span class="p">)</span>
</code></pre></div></div> <p>If you want to speed things up a little, download the csv file to your local drive and place it in the same folder as where you’re running Jupyter Notebook, then execute this code.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./Artworks.csv'</span><span class="p">)</span>
</code></pre></div></div> <p>Execute <strong>df_moma</strong> to see what’s inside this variable.</p> <p><img src="../../assets/images/moma/pic_moma_nan.jpg" alt="NaN" height="70%" width="70%" class="center-image" /></p> <p>Upon inspecting the data, you should see that there’re large number of records that has the value of <strong>NaN</strong>, which in computer science lingo means <strong>“not a number”</strong>, which also means there is an invalid record in the dataset. So before we begin to do anything beyond this, we need to for fill those records up with something else other than a <strong>NaN</strong> because it will cause issues with Pandas and Python down the line. We use a function call <strong>fillna</strong> to replace any <strong>NaN</strong> value with something we desinate.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span><span class="p">[[</span><span class="s">'Artist'</span><span class="p">,</span><span class="s">'Nationality'</span><span class="p">,</span><span class="s">'BeginDate'</span><span class="p">,</span>
         <span class="s">'Gender'</span><span class="p">,</span><span class="s">'Medium'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_moma</span><span class="p">[[</span><span class="s">'Artist'</span><span class="p">,</span><span class="s">'Nationality'</span><span class="p">,</span><span class="s">'BeginDate'</span><span class="p">,</span>
<span class="s">'Gender'</span><span class="p">,</span><span class="s">'Medium'</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">'Unknown'</span><span class="p">)</span>
</code></pre></div></div> <p>This line of code lets us look into each of these columns and find any <strong>NaN</strong> values and replace them with the word <strong>“Unknown”</strong>. We’re now ready to move forward with more advanced date processing techniques.</p> <hr /> <h1 id="step-2">Step 2</h1> <h3 id="data-processing">Data Processing</h3> <p>Now that we have imported the whole 130,000 records of MoMA’s collection, say we want to see which is their largest collection, we can do something like - look at every record and see what “Medium” it uses and count them all. And finally give me a sorted result which tells me what is their biggest collection is based on the Medium.</p> <p>To do this we need to call a <strong>Function</strong> that allows us to track duplicates. We have used this in previous sessions and it looks something like this. Type the following in and execute.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">list_duplicates</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">tally</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="n">tally</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="n">locs</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">locs</span> <span class="ow">in</span> <span class="n">tally</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <p>At this point, it’s ok if you don’t know how this function works. There’re quite a bit of short form writing in there so it’s a bit harder to read than usual. For now, treat it like a blackbox or a copy / paste button where you know exactly what it does and what you need to do to call the function. For more information on Python Functions, click the following for a deep dive into the subject.</p> <center><button class="button special fit"> <a href="https://www.w3schools.com/python/python_functions.asp">Deep Dive: Python Functions</a> </button></center> <p><br /><br /></p> <p>Now let’s call the function and have it list all the unique art media in the collection.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medium</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dup</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_duplicates</span><span class="p">(</span><span class="n">df_moma</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))):</span>
    <span class="n">medium</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Medium'</span><span class="p">,</span> <span class="s">'Number Of Artwork'</span><span class="p">]</span>
<span class="n">df_medium</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">medium</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</code></pre></div></div> <p>First you need to create an empty list to store all the items being found. The next line is a bit complex, it first passes the column with header <strong>[‘Medium’]</strong> to the function while ensuring it’s passed as a <strong>string</strong>. The function sends back with a list of lists, first listing all the unique medium names, and then the row number in which the medium name had been found. So we just need to store all that information into the <strong>medium</strong> variable. <code class="highlighter-rouge">(dup[1])</code> is a list of all the row numbers where the medium is found, <code class="highlighter-rouge">len(dup[1])</code> is the <strong>length</strong> of that list, which essentially tells me how many times that medium is found in the collection.</p> <p>Next we give the new list a label and create a new Pandas DataFrame for it. So now when you type in the following, you can show the dataframe and have it be sorted at the same time.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_medium</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <p><img src="../../assets/images/moma/pic_moma_mediumsortedlist.jpg" alt="test image size" height="70%" width="70%" class="center-image" /></p> <p>So now we know the largest collection MoMA has is photography and a large number of artwork have unknown media type.</p> <p>Now let’s say you want to look for specific <strong>keywords</strong> in the collection that you would associate with paintings, you can do something like this.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">searchfor</span> <span class="o">=</span> <span class="p">[</span><span class="s">'paint'</span><span class="p">,</span><span class="s">'oil'</span><span class="p">,</span><span class="s">'canvas'</span><span class="p">,</span><span class="s">'Casein'</span><span class="p">]</span>
<span class="n">df_medium</span><span class="p">[</span><span class="n">df_medium</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">searchfor</span><span class="p">))]</span>
</code></pre></div></div> <center><button class="button special fit"> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.contains.html">Deep Dive: Pandas Str Contains</a> </button></center> <p><img src="../../assets/images/moma/pic_moma_mediumstrcontains.jpg" alt="test image size" height="70%" width="70%" class="center-image" /></p> <p>Now combine the sort function with the search function and write it all at once.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_medium</span><span class="p">[</span><span class="n">df_medium</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">searchfor</span><span class="p">))]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <p><img src="../../assets/images/moma/pic_moma_mediumstrcontainssorted.jpg" alt="test image size" height="50%" width="50%" class="center-image" /></p> <p>Now let’s try to use the same method of finding duplicates to see which artist has the largest number of work at MoMA.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">artists</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dup</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_duplicates</span><span class="p">(</span><span class="n">df_moma</span><span class="p">[</span><span class="s">'Artist'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))):</span>
    <span class="n">artists</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
                    <span class="n">df_moma</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s">'Nationality'</span><span class="p">],</span>
                    <span class="n">df_moma</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s">'BeginDate'</span><span class="p">],</span>
                    <span class="n">df_moma</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s">'EndDate'</span><span class="p">],</span>
                    <span class="n">df_moma</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s">'Gender'</span><span class="p">],</span>
                    <span class="n">df_moma</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]][</span><span class="s">'Classification'</span><span class="p">]])</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Artist'</span><span class="p">,</span> <span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="s">'Nationality'</span><span class="p">,</span> <span class="s">'BirthYear'</span><span class="p">,</span> <span class="s">'DeathYear'</span><span class="p">,</span> <span class="s">'Gender'</span><span class="p">,</span><span class="s">'Classification'</span><span class="p">]</span>
<span class="n">df_artists</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">artists</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df_artists</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <p><img src="../../assets/images/moma/pic_moma_artistworksorted.jpg" alt="test image size" height="50%" width="50%" class="center-image" /></p> <p>We can also single out individual artist and look at the variety of work based on medium.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_picasso</span> <span class="o">=</span> <span class="n">df_moma</span><span class="p">[</span><span class="n">df_moma</span><span class="p">[</span><span class="s">'Artist'</span><span class="p">]</span><span class="o">==</span><span class="s">'Pablo Picasso'</span><span class="p">]</span>
<span class="n">picasso</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dup</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_duplicates</span><span class="p">(</span><span class="n">df_picasso</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))):</span>
    <span class="n">picasso</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Type of Work'</span><span class="p">,</span> <span class="s">'Number Of Artwork'</span><span class="p">]</span>
<span class="n">df_picassoWork</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">picasso</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df_picassowork</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <p><img src="../../assets/images/moma/pic_moma_picassomediumsorted.jpg" alt="test image size" height="50%" width="50%" class="center-image" /></p> <p>So it turns out, MoMA has over one thousand pieces of art work by Picasso and almost 25% of that are litographic work!</p> <hr /> <h1 id="step-3">Step 3</h1> <h3 id="date-created-vs-date-aquired">Date Created VS Date Aquired</h3> <p>We are diving deeper and deeper into data processing with Pandas as we continue to work with the same data set. This next exercise will dive right into one of the graphs <a href="https://fivethirtyeight.com/features/a-nerds-guide-to-the-2229-paintings-at-moma/">Oliver Roeder</a> had done at <a href="https://fivethirtyeight.com/">FiveThirtyEight</a> in which he graphed the year in which a painting had been painted versus the year in which the painted had been acquired by MoMA. It’s a simple idea but to actually create this graph, it’s anything but simple. We will have to rely on everything we have learned so far and more!</p> <p>Let’s open up a new notebook start fresh, and import the following packages.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="k">as</span> <span class="n">py</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">download_plotlyjs</span><span class="p">,</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">iplot</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">re</span><span class="p">,</span> <span class="n">datetime</span>

<span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <p>Import the CSV file as we did before, again, your choice if you want to load it remotely or locally.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://github.com/MuseumofModernArt/collection/blob/master/Artworks.csv'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./Artworks.csv'</span><span class="p">)</span>
</code></pre></div></div> <p>And again, let’s clean up all the missing values which is represented by <strong>NaN</strong> and fill that with the text <strong>Unknown</strong>. For more on how to work with <strong>Missing Data</strong> in Pandas, click here.</p> <center><button class="button special fit"> <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html">Deep Dive: Pandas Missing Data</a> </button></center> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span><span class="p">[[</span><span class="s">'Artist'</span><span class="p">,</span><span class="s">'Nationality'</span><span class="p">,</span><span class="s">'Date'</span><span class="p">,</span><span class="s">'BeginDate'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">,</span><span class="s">'DateAcquired'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_moma</span><span class="p">[[</span><span class="s">'Artist'</span><span class="p">,</span><span class="s">'Nationality'</span><span class="p">,</span><span class="s">'Date'</span><span class="p">,</span><span class="s">'BeginDate'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">,</span><span class="s">'DateAcquired'</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">'Unknown'</span><span class="p">)</span>
</code></pre></div></div> <p>Now let’s look at the 2 column of data we’re interested in working with, DateAcquired and Date, you should see something like the following.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span><span class="p">[[</span><span class="s">'DateAcquired'</span><span class="p">,</span><span class="s">'Date'</span><span class="p">]]</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="https://plot.ly/~prattitl/101.embed"></iframe> <p>Immediately we notice that the date format is diffent between the 2 columns, and even within each column, there are a lot of inconsistensies in the format. This is one of the quintessential chores in data science to search through and clear data for inconsistencies.</p> <p>To do that let’s talk through what the approach is, and simplify the problem by only looking at one of the columns first. The Date Acquired seems to be a bit more consistent at first glance, it seems most of the rows have this xxxx-xx-xx format. So let’s take a deeper look into this.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">(</span><span class="n">df_moma</span><span class="o">.</span><span class="n">DateAcquired</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'(\d{4})-(\d{1,2})-(\d{1,2})$'</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">q</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/105.embed"></iframe> <p><strong>df_moma.DateAcquired</strong> is a short form to only show the DataAcquired column of the df_moma dataframe. It can also be written as <strong>df_moma[‘DateAcquired’]</strong>, it’ll give us the same thing. The <strong>for row in x</strong> loop goes into every single row of data. <strong>q = re.search(r’(\d{4})-(\d{1,2})-(\d{1,2})$’, row)</strong> is to use a very powerful function call <strong>Regular Expression</strong> to sift through the data looking for patterns. Regular Expression is a rabbit hole, it was invented in the 1950s as a mathematical formal language and people have built search engines and word processors with it. For a deeper understanding, I’d recommend doing a more extensive reading on this subject. For a deeper look at how to use it pragmatically with python, click the following link.</p> <center><button class="button special fit"> <a href="https://www.dataquest.io/blog/regex-cheatsheet/">Deep Dive: Regular Expression</a> </button></center> <p><br /></p> <p>But let’s try to break it down so we have a basic understanding.</p> <p><code class="highlighter-rouge">re.search(r'(\d{4})-(\d{1,2})-(\d{1,2})$', row)</code> is made up of <code class="highlighter-rouge">re.search(a,b)</code>, which is to look for pattern a inside b. The <code class="highlighter-rouge">r''</code> quote is a convention that defines everything within the quotes are “raw” strings. <code class="highlighter-rouge">\d</code> is any digit between 0-9. Used along with <code class="highlighter-rouge">{4}</code> will look for any 4 digits repeated 4 times. <code class="highlighter-rouge">\d{1,2}</code> means look for digits repeated 1 to 2 times. So in human language, look for this pattern, digits that has been repeated 4 times, then a hyphen, then 1 to 2 digits, then another hyphen, then another 1 to 2 digits. Put this whole thing under a variable <strong>q</strong> means, if the search is positive, return True and store that in <strong>q</strong>.</p> <p>Thus, <code class="highlighter-rouge">if not q:</code> means if the pattern didn’t match, then <code class="highlighter-rouge">print(row)</code> show me the result.</p> <p>So from the results we see a lot of <strong>Unknown</strong>, but unless we go through each entry one by one, we can’t be sure if that is the only deviation, so let’s add to the funciton and identify all the unique variations.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dateAcquired_nullValue</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">(</span><span class="n">df_moma</span><span class="o">.</span><span class="n">DateAcquired</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'(\d{4})-(\d{1,2})-(\d{1,2})$'</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">q</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">dateAcquired_nullValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div> <p>We first create an empty list and inside the loop, pass all the values that doesn’t match the pattern into the variable. So we end with a list of all the deviations. We then use a function to look for unique values.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">list_duplicates</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">list_duplicates</span><span class="p">(</span><span class="n">dateAcquired_nullValue</span><span class="p">)</span>
</code></pre></div></div> <p>Here, a <strong>list_duplicate</strong> function is created to look for unique items. And low and behold, we get this as a result - <code class="highlighter-rouge">['Unknown', '1977-08', '1975-01', '1994', '1961']</code>. So other than Unknown, we also have 2 other date format we have to account for.</p> <p>Now the <strong>Date</strong> column seems like it’s a lot more complex. Just by scrolling through the data we can already see there is <strong>xxxx, xxxx-xx, c. xxxx, c. xxxx-xx, xxxx-xxxx</strong>… so we will have to come up with another <strong>regular expression pattern</strong> to sift through that data.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">date_nullValue</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="p">(</span><span class="n">df_moma</span><span class="o">.</span><span class="n">Date</span><span class="p">):</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'^.*(\d{4}).*'</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">q</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">date_nullValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</code></pre></div></div> <p>For this search pattern <code class="highlighter-rouge">re.search(r'^.*(\d{4}).*', row)</code>, we can just concentrate on this part <code class="highlighter-rouge">^.*(\d{4}).*</code>. <code class="highlighter-rouge">^</code> forces the search pattern right at the start of the string. <code class="highlighter-rouge">.</code> is any character and <code class="highlighter-rouge">*</code> is repeated however many times. So reading this together <code class="highlighter-rouge">^.*(\d{4})</code> is it looks for a 4 digit number and ignore anything that comes before, <code class="highlighter-rouge">^.*(\d{4}).*</code> thus, adding another <code class="highlighter-rouge">.*</code> after that is to say, look for a 4 digit code and ignore anything that comes before and after.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">list_duplicates</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">list_duplicates</span><span class="p">(</span><span class="n">date_nullValue</span><span class="p">)</span>
</code></pre></div></div> <p>You should see a big list of deviations that would be very hard to sift through without the use of regular expression.</p> <p>Now that we know the data has these many inconsistencies, let’s get rid of them. But as a general practice, we don’t necessarily want to delete records. Instead, we can create a copy of the data with a filter so we get a clean dataset. To do this we first create 2 lists that contains all the inconsistent date formats.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dateAcquired_nullValueDup</span> <span class="o">=</span> <span class="n">list_duplicates</span><span class="p">(</span><span class="n">dateAcquired_nullValue</span><span class="p">)</span>
<span class="n">date_nullValueDup</span> <span class="o">=</span> <span class="n">list_duplicates</span><span class="p">(</span><span class="n">date_nullValue</span><span class="p">)</span>
</code></pre></div></div> <p>We’re essentially just repeating the same function earlier but now passing the results into a new variable. Then we do this.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma_known</span> <span class="o">=</span> <span class="n">df_moma</span><span class="p">[</span><span class="o">~</span><span class="n">df_moma</span><span class="p">[</span><span class="s">'DateAcquired'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">dateAcquired_nullValueDup</span><span class="p">)]</span>
</code></pre></div></div> <p>Let’s break it down again. <code class="highlighter-rouge">dateAcquired_nullValueDup</code> is a list of filter words. <code class="highlighter-rouge">df_moma['DateAcquired'].isin()</code> is a way to pass the column of data and see if any of the rows is in whatever has been passed into <code class="highlighter-rouge">isin()</code>. So essentially this will give a list of True False value showing us all the records that is in that filter list. However, we want a record that is not in the filter list, so we add that little <code class="highlighter-rouge">~</code> tilda in front.</p> <p>So we have reduced the dataframe by using a list of keywords as filter. Now let’s do that again with the other list.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma_known_known</span> <span class="o">=</span> <span class="n">df_moma_known</span><span class="p">[</span><span class="o">~</span><span class="n">df_moma_known</span><span class="p">[</span><span class="s">'Date'</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">date_nullValueDup</span><span class="p">)]</span>
</code></pre></div></div> <p>Now although we have cleaned up the data by eliminated all the null or unknown value records, we have yet to change the date format to something that can be used. Since we can say for sure that the year is the only consistent value between the 2 columns, we need to find a way to extract that information. We’ll do it with regular expression again.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="n">datePatternToExtract</span> <span class="o">=</span> <span class="s">r'^.*(\d{4}).*'</span>
<span class="n">dateAcquiredPatternToExtract</span> <span class="o">=</span> <span class="s">r'^(\d{4}).*'</span>
<span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'DateCreated'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'Date'</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">datePatternToExtract</span><span class="p">)</span>
<span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'DateAcquiredFormtted'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'DateAcquired'</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">dateAcquiredPatternToExtract</span><span class="p">)</span>
</code></pre></div></div> <p>For this part, we’re using a native Pandas function <strong>str.extract</strong> in combination with regular expression to create a new column with the proper year value. We first create 2 patterns, 1 for the Date column and the other for the Date Acquired column. The patter is very similar except for the beginning. Then we created 2 new columns and pass all the extracted values there.</p> <p>When you execute this, you might get an error message that reads something like this,</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="k">from</span> <span class="n">a</span> <span class="n">DataFrame</span><span class="o">.</span>
<span class="n">Try</span> <span class="n">using</span> <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span><span class="n">col_indexer</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span> <span class="n">instead</span>
</code></pre></div></div> <p>You can ignore the message and move on. The last step in cleaning up the date format is to get rid of a single row of data that has the wrong date. The acquisition date says it’s from the 1200’s but you know that can’t be correct because the museum didn’t exist. Execute this code to get rid that specific record.</p> <p><code class="highlighter-rouge">df_moma_known_known.drop(129985, inplace=True)</code></p> <p>Since there’re still over 120,000 records, let’s further filter the data and then do the visualization.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medium</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dup</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_duplicates</span><span class="p">(</span><span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))):</span>
    <span class="n">medium</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Medium'</span><span class="p">,</span> <span class="s">'Number Of Artwork'</span><span class="p">]</span>
<span class="n">df_medium</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">medium</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df_medium</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/109.embed"></iframe> <p>You can choose to filter the records in different ways but let’s say for now we will do it by medium. We’ll first make a list of all the medium and show its collection size. Then say we will make a few new dataframes based on medium.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_Gelatin</span> <span class="o">=</span> <span class="n">df_moma_known_known</span><span class="p">[</span><span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">==</span><span class="s">'Gelatin silver print'</span><span class="p">]</span>
<span class="n">df_Lithograph</span> <span class="o">=</span> <span class="n">df_moma_known_known</span><span class="p">[</span><span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">==</span><span class="s">'Lithograph'</span><span class="p">]</span>
<span class="n">df_Oil</span> <span class="o">=</span> <span class="n">df_moma_known_known</span><span class="p">[</span><span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">==</span><span class="s">'Oil on canvas'</span><span class="p">]</span>
<span class="n">df_Albumen</span> <span class="o">=</span> <span class="n">df_moma_known_known</span><span class="p">[</span><span class="n">df_moma_known_known</span><span class="p">[</span><span class="s">'Medium'</span><span class="p">]</span><span class="o">==</span><span class="s">'Albumen silver print'</span><span class="p">]</span>
</code></pre></div></div> <p>Now to create the actual graph, we’ll use a place holder variable so if you want to change to a different medium, you just need to change the first variable.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_placeholder</span> <span class="o">=</span> <span class="n">df_Oil</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'DateAcquiredFormtted'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'DateCreated'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s">'markers'</span><span class="p">,</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s">'rgba(200, 200, 200, .3)'</span><span class="p">,</span>
            <span class="p">)</span> 
        <span class="p">)</span>

<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">'&lt;b&gt;MoMA Year Acquired VS Year Created&lt;/b&gt;&lt;br&gt;'</span><span class="o">+</span> <span class="n">df_placeholder</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'Medium'</span><span class="p">]</span> <span class="o">+</span><span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_placeholder</span><span class="p">)),</span>
    <span class="n">hovermode</span> <span class="o">=</span> <span class="s">'closest'</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">'Date Acquired'</span><span class="p">,</span>
            <span class="n">ticklen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">zeroline</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
            <span class="n">gridwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">),</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">'Date Created'</span><span class="p">,</span>
            <span class="n">ticklen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">gridwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">),</span>
    <span class="n">showlegend</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

<span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">'MoMA Year Acquired VS Year Created'</span><span class="o">+</span> <span class="n">df_placeholder</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'Medium'</span><span class="p">])</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/103.embed"></iframe> <p>Congratulations for completing this step. Now you’re ready to move on to the next step.</p> <hr /> <h1 id="step-4">Step 4</h1> <h3 id="moma-collection-by-size">MoMA Collection by Size</h3> <p>For this exercise we will go back to what <a href="https://fivethirtyeight.com/features/a-nerds-guide-to-the-2229-paintings-at-moma/">Oliver Roeder</a> had done at <a href="https://fivethirtyeight.com/">FiveThirtyEight</a> and look at the visualization that compare the size of the artwork in the collection.</p> <p>Again we’ll start fresh with a new notebook and import all the libraries.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="k">as</span> <span class="n">py</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">from</span> <span class="nn">plotly.offline</span> <span class="kn">import</span> <span class="n">download_plotlyjs</span><span class="p">,</span> <span class="n">init_notebook_mode</span><span class="p">,</span> <span class="n">iplot</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">re</span><span class="p">,</span> <span class="n">datetime</span>

<span class="n">init_notebook_mode</span><span class="p">(</span><span class="n">connected</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div> <p>And we bring in the csv file.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'https://github.com/MuseumofModernArt/collection/blob/master/Artworks.csv'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./Artworks.csv'</span><span class="p">)</span>
</code></pre></div></div> <p>And again, let’s clean up all the missing values.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma</span><span class="p">[[</span><span class="s">'Artist'</span><span class="p">,</span><span class="s">'Nationality'</span><span class="p">,</span><span class="s">'Date'</span><span class="p">,</span><span class="s">'BeginDate'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">,</span><span class="s">'DateAcquired'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df_moma</span><span class="p">[[</span><span class="s">'Artist'</span><span class="p">,</span><span class="s">'Nationality'</span><span class="p">,</span><span class="s">'Date'</span><span class="p">,</span><span class="s">'BeginDate'</span><span class="p">,</span><span class="s">'Gender'</span><span class="p">,</span><span class="s">'DateAcquired'</span><span class="p">]]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">'Unknown'</span><span class="p">)</span>
</code></pre></div></div> <p>Remember that there’re over 130,000 records and it’s simply not feasible to visualize every single item in the collection, we will make an arbitrary decision and say the visualization will be based on their classification, and in this case, the architecture collection. You can change this to what ever you want. Say if you want to look at the sizes of all of Picasso’s work, it’s the same procedure.</p> <p>First look at how many classifications there are that are related to architecture. Bring in the function that looks for duplicates.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">list_duplicates</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">tally</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
        <span class="n">tally</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span><span class="p">((</span><span class="n">key</span><span class="p">,</span><span class="n">locs</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">locs</span> <span class="ow">in</span> <span class="n">tally</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div> <p>Then call the function and have it list all the unique classifications.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">classification</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">dup</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">list_duplicates</span><span class="p">(</span><span class="n">df_moma</span><span class="p">[</span><span class="s">'Classification'</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">))):</span>
    <span class="n">classification</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">dup</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">dup</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Classification'</span><span class="p">,</span> <span class="s">'Number Of Artwork'</span><span class="p">]</span>
<span class="n">df_classification</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">classification</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">df_classification</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s">'Number Of Artwork'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/111.embed"></iframe> <p>From this list you can see there is a Mies van der Rohe Archive, an architecture collection, and a Frank Lloyd Wright Archive, all related to architecture. So we’ll create a new dataframe that would use those terms as filter words.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">searchfor</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Mies van der Rohe Archive'</span><span class="p">,</span><span class="s">'Architecture'</span><span class="p">,</span><span class="s">'Frank Lloyd Wright Archive'</span><span class="p">]</span>
<span class="n">df_moma_archi</span> <span class="o">=</span> <span class="n">df_moma_notNull</span><span class="p">[</span><span class="n">df_moma_notNull</span><span class="p">[</span><span class="s">'Classification'</span><span class="p">]</span><span class="o">.</span><span class="nb">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s">'|'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">searchfor</span><span class="p">))]</span>
</code></pre></div></div> <p>Since we know we will base our on the Height and Width columns, we need to ensure we don’t have any missing data.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_moma_archi_hasSize</span> <span class="o">=</span> <span class="n">df_moma_archi</span><span class="p">[</span><span class="o">~</span><span class="n">df_moma_archi</span><span class="p">[</span><span class="s">'Height (cm)'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
<span class="n">df_moma_archi_hasSize</span> <span class="o">=</span> <span class="n">df_moma_archi_hasSize</span><span class="p">[</span><span class="o">~</span><span class="n">df_moma_archi_hasSize</span><span class="p">[</span><span class="s">'Width (cm)'</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</code></pre></div></div> <p>Now the data should be ready to pass to Plotly.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_placeholder</span> <span class="o">=</span> <span class="n">df_moma_archi_hasSize</span>
<span class="n">hovertext</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df_placeholder</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">hovertext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">'Artist'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s">'DateAcquired'</span><span class="p">]</span><span class="o">+</span> <span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span> <span class="p">)</span>
<span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'Height (cm)'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'Width (cm)'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s">'markers'</span><span class="p">,</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">hovertext</span><span class="p">,</span>
        <span class="p">)</span>
<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">'&lt;b&gt;MoMA Drawing Size&lt;/b&gt;&lt;br&gt;'</span><span class="o">+</span> <span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_placeholder</span><span class="p">)),</span>
    <span class="n">hovermode</span> <span class="o">=</span> <span class="s">'closest'</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">'Height (cm)'</span><span class="p">,</span>
            <span class="n">ticklen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">zeroline</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
            <span class="n">gridwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">),</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">'Width (cm)'</span><span class="p">,</span>
            <span class="n">ticklen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">gridwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">),</span>
    <span class="n">showlegend</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s">'rgba(0,0,0,0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s">'rgba(0,0,0,0)'</span>
    <span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">'MoMA Drawing Size scattered'</span><span class="p">)</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/70.embed"></iframe> <p>Now let’s not stop here because we only got a scatter plot, but we want to actually see the rectangles. To have plotly draw shapes, we’ll need to learn about the syntax. For a deep dive into Plot.ly shapes, click here.</p> <center><button class="button special fit"> <a href="https://plot.ly/python/shapes/">Deep Dive: Plot.ly Shapes</a> </button></center> <p><br /></p> <p>Essentially we learn that shapes are drawn in the layout section rather than in the data section. And shapes are drawn as a dictionary like this. Dictionary is a type of data structure in Python. For a deep dive on the subject, click here.</p> <center><button class="button special fit"> <a href="https://www.w3schools.com/python/python_dictionaries.asp">Deep Dive: Python Dictionary</a> </button></center> <p><br /></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">'shapes'</span><span class="p">:</span> <span class="p">[</span>
    <span class="c"># unfilled Rectangle</span>
    <span class="p">{</span>
        <span class="s">'type'</span><span class="p">:</span> <span class="s">'rect'</span><span class="p">,</span>
        <span class="s">'x0'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'y0'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'x1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'y1'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s">'line'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'color'</span><span class="p">:</span> <span class="s">'rgba(128, 0, 128, 1)'</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="c"># filled Rectangle</span>
    <span class="p">{</span>
        <span class="s">'type'</span><span class="p">:</span> <span class="s">'rect'</span><span class="p">,</span>
        <span class="s">'x0'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s">'y0'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'x1'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s">'y1'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">'line'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">'color'</span><span class="p">:</span> <span class="s">'rgba(128, 0, 128, 1)'</span><span class="p">,</span>
            <span class="s">'width'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s">'fillcolor'</span><span class="p">:</span> <span class="s">'rgba(128, 0, 128, 0.7)'</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">]</span>
</code></pre></div></div> <p>So now we need to figure a way to create this dictionary. We know the shape dictionary has few parameters: type, x0, y0, x1, y1, line, and fillcolor. We know what the type should be, we know all of rectangles should start at (0,0), we know what line and fillcolor should be, so all we need is to pass the (x1,y1) location to this. In Python, we can create a dictionary like this.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">'type'</span><span class="p">,</span><span class="s">'xref'</span><span class="p">,</span><span class="s">'yref'</span><span class="p">,</span><span class="s">'x0'</span><span class="p">,</span><span class="s">'y0'</span><span class="p">,</span><span class="s">'x1'</span><span class="p">,</span><span class="s">'y1'</span><span class="p">,</span><span class="s">'line'</span><span class="p">,</span><span class="s">'fillcolor'</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s">'rect'</span><span class="p">,</span><span class="s">'x'</span><span class="p">,</span><span class="s">'y'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,{</span><span class="s">'color'</span><span class="p">:</span> <span class="s">'rgb(55,55,55)'</span><span class="p">,</span><span class="s">'width'</span><span class="p">:</span><span class="mi">1</span><span class="p">,},</span><span class="s">'rgba(55,55,55,0.5)'</span><span class="p">]</span>
<span class="n">temp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">values</span><span class="p">))</span>
</code></pre></div></div> <p>And if we pass that variable to a plot we can get a single rectangle.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">trace0</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
    <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="s">'Rectangle reference to the plot'</span><span class="p">,</span>
          <span class="s">'Rectangle reference to the axes'</span><span class="p">],</span>
    <span class="n">mode</span><span class="o">=</span><span class="s">'text'</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace0</span><span class="p">]</span>
<span class="n">layout</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'xaxis'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'range'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
        <span class="s">'showgrid'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s">'yaxis'</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">'range'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="p">},</span>
    <span class="s">'shapes'</span><span class="p">:</span> <span class="p">[</span><span class="n">temp</span><span class="p">],</span>
<span class="p">}</span>
<span class="n">fig</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'data'</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="s">'layout'</span><span class="p">:</span> <span class="n">layout</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">'shapes-rectangle-ref'</span><span class="p">)</span>
</code></pre></div></div> <p>So all we need to do is to create a list of dictionaries that will cycle through all the Height and Width data in the records and pass them to the dictionary.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rects</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df_placeholder</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">'type'</span><span class="p">,</span><span class="s">'xref'</span><span class="p">,</span><span class="s">'yref'</span><span class="p">,</span><span class="s">'x0'</span><span class="p">,</span><span class="s">'y0'</span><span class="p">,</span><span class="s">'x1'</span><span class="p">,</span><span class="s">'y1'</span><span class="p">,</span><span class="s">'line'</span><span class="p">,</span><span class="s">'fillcolor'</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s">'rect'</span><span class="p">,</span><span class="s">'x'</span><span class="p">,</span><span class="s">'y'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">row</span><span class="p">[</span><span class="s">'Width (cm)'</span><span class="p">],</span>
              <span class="n">row</span><span class="p">[</span><span class="s">'Height (cm)'</span><span class="p">],</span>
              <span class="p">{</span><span class="s">'color'</span><span class="p">:</span> <span class="s">'rgb(200,200,200)'</span><span class="p">,</span><span class="s">'width'</span><span class="p">:</span><span class="mi">1</span><span class="p">,},</span>
              <span class="s">'rgba(55,55,55,0.1)'</span><span class="p">]</span>
    <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">values</span><span class="p">)))</span>
</code></pre></div></div> <p>Once that’s done, you can create the graph again with this new variable.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_placeholder</span> <span class="o">=</span> <span class="n">df_moma_archi_hasSize</span>

<span class="n">hovertext</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rects</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">df_placeholder</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">hovertext</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">'Artist'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s">'DateAcquired'</span><span class="p">]</span><span class="o">+</span> <span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span> <span class="p">)</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s">'type'</span><span class="p">,</span><span class="s">'xref'</span><span class="p">,</span><span class="s">'yref'</span><span class="p">,</span><span class="s">'x0'</span><span class="p">,</span><span class="s">'y0'</span><span class="p">,</span><span class="s">'x1'</span><span class="p">,</span><span class="s">'y1'</span><span class="p">,</span><span class="s">'line'</span><span class="p">,</span><span class="s">'fillcolor'</span><span class="p">]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s">'rect'</span><span class="p">,</span><span class="s">'x'</span><span class="p">,</span><span class="s">'y'</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>
              <span class="n">row</span><span class="p">[</span><span class="s">'Width (cm)'</span><span class="p">],</span>
              <span class="n">row</span><span class="p">[</span><span class="s">'Height (cm)'</span><span class="p">],</span>
              <span class="p">{</span><span class="s">'color'</span><span class="p">:</span> <span class="s">'rgb(200,200,200)'</span><span class="p">,</span><span class="s">'width'</span><span class="p">:</span><span class="mi">1</span><span class="p">,},</span>
              <span class="s">'rgba(55,55,55,0.1)'</span><span class="p">]</span>
    <span class="n">rects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">values</span><span class="p">)))</span>

<span class="n">trace</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'Height (cm)'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">df_placeholder</span><span class="p">[</span><span class="s">'Width (cm)'</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="s">'markers'</span><span class="p">,</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">hovertext</span><span class="p">,</span>
        <span class="n">marker</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s">'rgba(255, 0, 0, .3)'</span><span class="p">,</span>
            <span class="p">)</span> 
        <span class="p">)</span>

<span class="n">layout</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">'MoMA Drawing Size&lt;br&gt;'</span><span class="o">+</span> <span class="s">'&lt;br&gt;'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_placeholder</span><span class="p">)),</span>
    <span class="n">hovermode</span> <span class="o">=</span> <span class="s">'closest'</span><span class="p">,</span>
    <span class="n">yaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">'Height (cm)'</span><span class="p">,</span>
            <span class="n">ticklen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">zeroline</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
            <span class="n">gridwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">),</span>
    <span class="n">xaxis</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s">'Width (cm)'</span><span class="p">,</span>
            <span class="n">ticklen</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">gridwidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
            <span class="p">),</span>
    <span class="n">shapes</span> <span class="o">=</span> <span class="n">rects</span><span class="p">,</span>
    <span class="n">showlegend</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s">'rgba(0,0,0,0)'</span><span class="p">,</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s">'rgba(0,0,0,0)'</span>
    <span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">layout</span><span class="p">)</span>

<span class="n">py</span><span class="o">.</span><span class="n">iplot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s">'MoMA Drawing Size'</span><span class="p">)</span>
</code></pre></div></div> <iframe width="100%" height="500" frameborder="0" scrolling="no" src="//plot.ly/~prattitl/66.embed"></iframe> <hr /> <h1 id="summary">Summary</h1> <h3 id="what-you-have-learned">What You have Learned</h3> <ul> <li>How to create and assign value to a variable</li> <li>How to create and assign values a list</li> <li>How to create and assign values a list of lists</li> <li>How to bring data into Python as text or csv files</li> <li>How to create and use a counter</li> <li>How to write a basic function</li> <li>How to call a basic function</li> <li>Basic loop structure - how to use for-loops</li> <li>How to import packages in Python</li> <li>How to use basic functions of packages like Pandas, Plotly, BeautifulSoup</li> <li>How to create interactive plots with Plotly.</li> </ul> </div> </article> <footer class="site-footer"> <div class="container"> <small class="block">&copy; 2019 ITL &middot; &lt;/&gt; Powered by <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://github.com/heiswayi/thinkspace">Thinkspace theme</a></small> </div> </footer> </main> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-XXXXX-XX']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </body> </html>
